(this["webpackJsonpmini-app"]=this["webpackJsonpmini-app"]||[]).push([[0],{138:function(e,t,c){},145:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c(20),s=c.n(a),i=c(14),r=c.n(i),o=c(13),j=c(4),l=(c(137),c(138),c(3)),d=function(e){var t=e.id,c=e.go;return Object(l.jsxs)(j.q,{id:t,children:[Object(l.jsx)(j.r,{children:"Spy"}),Object(l.jsxs)(j.j,{children:[Object(l.jsx)(j.g,{children:Object(l.jsx)(j.c,{stretched:!0,size:"l",mode:"secondary",onClick:c,"data-to":"game",children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})}),Object(l.jsx)(j.g,{children:Object(l.jsx)(j.c,{stretched:!0,size:"l",mode:"secondary",onClick:c,"data-to":"locations",children:"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043b\u043e\u043a\u0430\u0446\u0438\u0438"})}),Object(l.jsx)(j.g,{children:Object(l.jsx)(j.c,{stretched:!0,size:"l",mode:"secondary",onClick:c,"data-to":"createLocations",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u0446\u0438\u044e"})})]})]})},b={university:"\u0423\u043d\u0438\u0432\u0435\u0440\u0441\u0438\u0442\u0435\u0442",hospital:"\u0411\u043e\u043b\u044c\u043d\u0438\u0446\u0430",embassy:"\u041f\u043e\u0441\u043e\u043b\u044c\u0441\u0442\u0432\u043e",movieStudio:"\u041a\u0438\u043d\u043e\u0441\u0442\u0443\u0434\u0438\u044f",partisanDetachment:"\u041f\u0430\u0440\u0442\u0438\u0437\u0430\u043d\u0441\u043a\u0438\u0438\u0306 \u043e\u0442\u0440\u044f\u0434",vegetableMarket:"\u041e\u0432\u043e\u0449\u0435\u0431\u0430\u0437\u0430",pirateShip:"\u041f\u0438\u0440\u0430\u0442\u0441\u043a\u0438\u0438\u0306 \u043a\u043e\u0440\u0430\u0431\u043b\u044c",polarStation:"\u041f\u043e\u043b\u044f\u0440\u043d\u0430\u044f \u0441\u0442\u0430\u043d\u0446\u0438\u044f",supermarket:"\u0421\u0443\u043f\u0435\u0440\u043c\u0430\u0440\u043a\u0435\u0442",theatre:"\u0422\u0435\u0430\u0442\u0440",passengerTrain:"\u041f\u0430\u0441\u0441\u0430\u0436\u0438\u0440\u0441\u043a\u0438\u0438\u0306 \u043f\u043e\u0435\u0437\u0434"},O=function(e){var t=e.id,c=e.go;return Object(l.jsxs)(j.q,{id:t,children:[Object(l.jsx)(j.r,{left:Object(l.jsx)(j.s,{onClick:c,"data-to":"home"}),children:"\u041b\u043e\u043a\u0430\u0446\u0438\u0438"}),Object(l.jsx)(j.j,{children:Object(l.jsx)(j.n,{children:b&&Object.keys(b).map((function(e){return Object(l.jsx)(j.e,{expandable:!0,children:b[e]},e)}))})})]})},u=c(23),h=function(e){var t=e.id,c=e.go,a=e.openLocationModal,s=e.startTimer,i=e.timer,r=e.stopTimer,d=e.setActiveUser,O=e.setSpyIds,h=Object(n.useState)(3),x=Object(o.a)(h,2),p=x[0],f=x[1],m=Object(n.useState)(1),v=Object(o.a)(m,2),y=v[0],g=v[1],S=Object(n.useState)({gameStart:!1,dealStart:!1}),k=Object(o.a)(S,2),C=k[0],z=k[1],L=Object(n.useState)(1),I=Object(o.a)(L,2),M=I[0],A=I[1],w=Object(n.useState)(""),T=Object(o.a)(w,2),K=T[0],V=T[1],W=Object(n.useState)([]),D=Object(o.a)(W,2),q=D[0],F=D[1];function P(e,t){e=Math.ceil(e),t=Math.floor(t);var c=Math.floor(Math.random()*(t-e))+e;return q.includes(c)&&(c=P(e,t)),c}return Object(l.jsxs)(j.q,{id:t,children:[Object(l.jsx)(j.r,{left:Object(l.jsx)(j.s,{onClick:c,"data-to":"home"}),children:"\u0418\u0433\u0440\u0430"}),!C.dealStart&&!C.gameStart&&Object(l.jsxs)(j.j,{children:[Object(l.jsx)(j.k,{children:"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430"}),Object(l.jsxs)(j.i,{children:[Object(l.jsx)(j.h,{top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u0433\u0440\u043e\u043a\u043e\u0432",status:p>=3&&p<=12?"valid":"error",children:Object(l.jsx)(j.m,{type:"number",name:"countOfPlayers",value:p,onChange:function(e){f(+e.target.value)}})}),Object(l.jsx)(j.h,{top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0448\u043f\u0438\u043e\u043d\u043e\u0432",status:12==p?2==y?"valid":"error":y>=1&&y<=2?"valid":"error",children:Object(l.jsx)(j.m,{type:"number",name:"countOfSpyes",value:y,onChange:function(e){g(+e.target.value)}})}),Object(l.jsx)(j.h,{children:Object(l.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){if(!(y<0||p<0||y>2||p>12)){z(Object(u.a)(Object(u.a)({},C),{},{dealStart:!0}));for(var e=[],t=1;t<=y;t+=1){for(var c=P(1,p);q.includes(c);)c=P(1,p);e.push(c)}F(e),O(e),V(b[Object.keys(b)[P(1,Object.keys(b).length)]])}},children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0430\u0447\u0443"})})]})]}),C.dealStart&&Object(l.jsxs)(j.g,{style:{textAlign:"center"},children:[Object(l.jsxs)(j.t,{style:{display:"block",marginBottom:10},children:["\u0418\u0433\u0440\u043e\u043a ",M,", \u043e\u0437\u043d\u0430\u043a\u043e\u043c\u0442\u0435\u0441\u044c \u0441 \u043b\u043e\u043a\u0430\u0446\u0438\u0435\u0439."]}),Object(l.jsxs)(j.d,{stretched:!0,mode:"vertical",children:[Object(l.jsx)(j.c,{stretched:!0,mode:"secondary",size:"m",onClick:function(){return a(q.includes(M)?"\u0412\u044b \u0448\u043f\u0438\u043e\u043d":K)},children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043b\u043e\u043a\u0430\u0446\u0438\u044e"}),M<p&&Object(l.jsx)(j.c,{stretched:!0,mode:"secondary",size:"m",onClick:function(){A(M+1),d(M+1)},children:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0438\u0433\u0440\u043e\u043a"}),M==p&&Object(l.jsx)(j.c,{stretched:!0,mode:"secondary",size:"m",onClick:function(){s(p),z({gameStart:!0,dealStart:!1})},children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})]})]}),C.gameStart&&Object(l.jsxs)(j.g,{style:{display:"flex",alignItems:"center",flexDirection:"column"},children:[Object(l.jsx)(j.t,{children:"\u0418\u0433\u0440\u0430 \u043d\u0430\u0447\u0430\u043b\u0430\u0441\u044c!"}),Object(l.jsx)(j.t,{style:{fontSize:"20px",margin:"10px"},children:i}),Object(l.jsx)(j.c,{stretched:!0,mode:"secondary",size:"m",onClick:function(){A(1),d(1),F([]),V(""),r(),z({gameStart:!1,dealStart:!1})},children:"\u0417\u0430\u043a\u043e\u043d\u0447\u0438\u0442\u044c \u0438\u0433\u0440\u0443"})]})]})},x=c(146),p=c(25),f=c(27),m=Object(f.b)({name:"locations",initialState:{},reducers:{addLocation:function(e,t){e[e.nextLocationId]=t.payload},removeLocation:function(e,t){e.hasOwnProperty(t.payload)&&delete e.locations[payload.payload]}}}),v=m.actions,y=m.reducer,g=v.addLocation,S=v.removeLocation,k=y,C=function(e){var t,c=e.id,a=e.go,s=Object(n.createRef)(),i=Object(p.b)(),r=Object(p.c)((function(e){return e.locations}));return Object(l.jsxs)(j.q,{id:c,children:[Object(l.jsx)(j.r,{left:Object(l.jsx)(j.s,{onClick:a,"data-to":"home"}),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u0446\u0438\u044e"}),Object(l.jsxs)(j.j,{children:[Object(l.jsxs)(j.g,{children:[Object(l.jsx)(j.h,{top:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043b\u043e\u043a\u0430\u0446\u0438\u0438",children:Object(l.jsx)(j.m,{type:"text",getRef:s})}),Object(l.jsx)(j.d,{style:{display:"flex",justifyContent:"center"},children:Object(l.jsx)(j.c,{style:{width:"300px"},mode:"outline",onClick:function(){i(g(s.current.value)),s.current.value=""},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]}),Object(l.jsx)(j.g,{children:null===(t=Object.keys(r))||void 0===t?void 0:t.map((function(e){return Object(l.jsx)(j.u,{after:Object(l.jsx)(j.l,{onClick:function(){return i(S(e))},children:Object(l.jsx)(x.a,{})}),children:r[e]},e)}))})]})]})},z=Object(f.a)({reducer:{locations:k}}),L=function(){var e=Object(n.useState)("bright_light"),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)("home"),i=Object(o.a)(s,2),b=i[0],u=i[1],x=Object(n.useState)(""),f=Object(o.a)(x,2),m=f[0],v=f[1],y=Object(n.useState)(""),g=Object(o.a)(y,2),S=g[0],k=g[1],L=Object(n.useState)(""),I=Object(o.a)(L,2),M=I[0],A=I[1],w=Object(n.useState)(""),T=Object(o.a)(w,2),K=T[0],V=T[1],W=Object(n.useState)(!1),D=Object(o.a)(W,2),q=D[0],F=D[1],P=Object(n.useState)(""),R=Object(o.a)(P,2),U=R[0],_=R[1],B=Object(n.useState)(1),E=Object(o.a)(B,2),J=E[0],G=E[1],H=Object(n.useState)([]),N=Object(o.a)(H,2),Q=N[0],X=N[1],Y=Object(n.useState)([]),Z=Object(o.a)(Y,2),$=Z[0],ee=Z[1];function te(e){var t=e-new Date;t<=0&&(ce(),q&&(r.a.send("VKWebAppFlashSetLevel",{level:1}),setTimeout((function(){r.a.send("VKWebAppFlashSetLevel",{level:0})}),500)));var c=t>0?Math.floor(t/1e3/60)%60:0,n=t>0?Math.floor(t/1e3)%60:0;A("".concat(c,":").concat(n<10?"0".concat(n):n))}var ce=function(){A(""),_(""),clearInterval(K),v("spy")};Object(n.useEffect)((function(){r.a.subscribe((function(e){var t=e.detail,c=t.type,n=t.data;"VKWebAppUpdateConfig"===c&&a(n.scheme),"VKWebAppFlashGetInfoResult"===c&&(F(n.is_available),n.is_available&&r.a.send("VKWebAppFlashSetLevel",{level:0}))}))}),[]);var ne=function(e){u(e.currentTarget.dataset.to)},ae=function(e){""!==e&&(Q.includes(J)&&$.push(e),v(""),_(""))},se=Object(l.jsxs)(j.p,{activeModal:m,children:[Object(l.jsxs)(j.o,{style:{height:"200px",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"18px"},onClose:function(){return ae(U)},id:"location",children:[S,Object(l.jsx)(j.h,{top:"\u0418\u043c\u044f",status:U&&U.length>0?"valid":"error",children:Object(l.jsx)(j.m,{type:"text",onChange:function(e){return _(e.target.value)}})}),Object(l.jsx)(j.c,{stretched:!0,mode:"secondary",size:"m",onClick:function(){return ae(U)},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]}),Object(l.jsxs)(j.o,{style:{height:"200px",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"18px"},onClose:function(){return ee([]),X([]),void v("")},id:"spy",children:["\u0428\u043f\u0438\u043e\u043d - ",$.join(",")]})]});return Object(l.jsx)(p.a,{store:z,children:Object(l.jsx)(j.f,{scheme:c,children:Object(l.jsx)(j.a,{children:Object(l.jsx)(j.b,{children:Object(l.jsx)(j.w,{modal:se,children:Object(l.jsx)(j.v,{children:Object(l.jsxs)(j.x,{activePanel:b,children:[Object(l.jsx)(O,{id:"locations",go:ne}),Object(l.jsx)(d,{id:"home",go:ne}),Object(l.jsx)(h,{id:"game",go:ne,openLocationModal:function(e,t){v("location"),k(e)},timer:M,startTimer:function(e){var t,c,n=(t=new Date,c=1,new Date(t.getTime()+6e4*c));te(n),V(setInterval((function(){return te(n)}),1e3))},stopTimer:ce,setActiveUser:G,setSpyIds:X}),Object(l.jsx)(C,{id:"createLocations",go:ne})]})})})})})})})};r.a.send("VKWebAppInit"),s.a.render(Object(l.jsx)(L,{}),document.getElementById("root"))}},[[145,1,2]]]);
//# sourceMappingURL=main.04206419.chunk.js.map