{"version":3,"sources":["panels/Home.js","static/locations.js","panels/Locations.js","panels/Game.js","store/reducers/locationsReducer.js","panels/createLocations.js","store/index.js","App.js","index.js"],"names":["Home","id","go","stretched","size","mode","onClick","LOCATIONS","university","hospital","embassy","movieStudio","partisanDetachment","vegetableMarket","pirateShip","polarStation","supermarket","theatre","passengerTrain","Locations","left","Object","keys","map","loc","expandable","Game","openLocationModal","startTimer","timer","stopTimer","setActiveUser","setSpyIds","useState","countOfPlayers","setCountOfPlayers","countOfSpyes","setCountOfSpyes","gameStart","dealStart","gameStatus","setGameStatus","currentPlayer","setCurrentPlayer","location","setLocation","spyUsers","setSpyUsers","getRandomInt","min","max","Math","ceil","floor","num","random","includes","top","status","type","name","value","onChange","evt","target","spyIds","i","push","length","style","textAlign","display","marginBottom","alignItems","flexDirection","fontSize","margin","locationsSlice","createSlice","initialState","reducers","addLocation","state","action","nextLocationId","payload","removeLocation","hasOwnProperty","locations","actions","reducer","CreateLocations","newLocation","createRef","dispatch","useDispatch","locationsList","useSelector","getRef","justifyContent","width","current","locationId","after","configureStore","locationsReducer","App","scheme","setScheme","activePanel","setActivePanel","activeModal","setActiveModal","setTimer","timerId","setTimerId","flashLightIsAvailable","setFlasLightIsAvailable","setName","activeUser","spyNames","setSpyNames","countdownTimer","deadline","diff","Date","bridge","send","level","setTimeout","minutes","seconds","clearInterval","useEffect","subscribe","detail","data","is_available","e","currentTarget","dataset","to","saveNameAndClose","modal","height","onClose","join","store","user","count","date","getTime","setInterval","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.04206419.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Panel, PanelHeader, Header, Button, Group, Cell, Div, Avatar } from '@vkontakte/vkui';\n\nconst Home = ({ id, go }) => (\n\t<Panel id={id}>\n\t\t<PanelHeader>Spy</PanelHeader>\n\t\t<Group>\n\t\t\t<Div>\n\t\t\t\t<Button stretched size=\"l\" mode=\"secondary\" onClick={go} data-to=\"game\">\n\t\t\t\t\tНачать игру\n\t\t\t\t</Button>\n\t\t\t</Div>\n\t\t\t<Div>\n\t\t\t\t<Button stretched size=\"l\" mode=\"secondary\" onClick={go} data-to=\"locations\">\n\t\t\t\t\tПосмотреть локации\n\t\t\t\t</Button>\n\t\t\t</Div>\n\t\t\t<Div>\n\t\t\t\t<Button stretched size=\"l\" mode=\"secondary\" onClick={go}\n\t\t\t\t\tdata-to=\"createLocations\">\n\t\t\t\t\tДобавить локацию\n\t\t\t\t</Button>\n\t\t\t</Div>\n\t\t</Group>\n\t</Panel>\n);\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n\tgo: PropTypes.func.isRequired,\n};\n\nexport default Home;\n","export const LOCATIONS = {\r\n    university: \"Университет\",\r\n    hospital: \"Больница\",\r\n    embassy: \"Посольство\",\r\n    movieStudio: \"Киностудия\",    \r\n    partisanDetachment: \"Партизанский отряд\",\r\n    vegetableMarket: \"Овощебаза\",\r\n    pirateShip: \"Пиратский корабль\",\r\n    polarStation: \"Полярная станция\",\r\n    supermarket: \"Супермаркет\",\r\n    theatre: \"Театр\",\r\n    passengerTrain: \"Пассажирский поезд\",\r\n}\r\n\r\nexport const STATUS = {\r\n    university: {\r\n        student: \"Студент\",\r\n        watchman: \"Вахтёр\",\r\n        rector: \"Ректор\",\r\n        professor: \"Профессор\",\r\n        graduateStudent: \"Аспирант\",\r\n    },\r\n    hospital: {\r\n        therapist: \"Терапевт\",\r\n        surgeon: \"Хирург\",\r\n        nurse: \"Медсестра\",\r\n        patient: \"Пациент\",\r\n    },\r\n    embassy: {\r\n        ambassador: 'Посол',\r\n        bodyguard: 'Телохранитель',\r\n    }\r\n}","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { Panel, PanelHeader, Header, Button, Group, Cell, Div, Avatar, PanelHeaderBack, List } from '@vkontakte/vkui';\r\nimport { LOCATIONS } from '../static';\r\n\r\nconst Locations = ({ id, go }) => (\r\n    <Panel id={id}>\r\n        <PanelHeader  left={<PanelHeaderBack onClick={go} data-to=\"home\" />}>\r\n             Локации\r\n        </PanelHeader>\r\n        <Group>\r\n            <List>\r\n                {LOCATIONS && Object.keys(LOCATIONS).map(loc => {\r\n                    return (\r\n                        <Cell expandable key={loc}>\r\n                            {LOCATIONS[loc]}\r\n                        </Cell>\r\n                    )\r\n                })}\r\n            </List>\r\n        </Group>\r\n    </Panel>\r\n);\r\n\r\nLocations.propTypes = {\r\n    id: PropTypes.string.isRequired,\r\n    go: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default Locations;\r\n","import React, { useState } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport {\r\n  Panel,\r\n  PanelHeader,\r\n  PanelHeaderBack,\r\n  Group,\r\n  Header,\r\n  FormLayout,\r\n  FormItem,\r\n  Input,\r\n  Button,\r\n  Div,\r\n  Paragraph,\r\n  ButtonGroup,\r\n} from \"@vkontakte/vkui\";\r\n\r\nimport { LOCATIONS } from '../static';\r\n\r\nconst Game = ({ id, go, openLocationModal, startTimer, timer, stopTimer, setActiveUser, setSpyIds }) => {\r\n\r\n  const [countOfPlayers, setCountOfPlayers] = useState(3);\r\n  const changeCountOfPlayers = (evt) => {\r\n    setCountOfPlayers(+evt.target.value);\r\n  }\r\n\r\n  const [countOfSpyes, setCountOfSpyes] = useState(1);\r\n  const changeCountOfSpyes = (evt) => {\r\n    setCountOfSpyes(+evt.target.value);\r\n  }\r\n\r\n  const [gameStatus, setGameStatus] = useState({\r\n    gameStart: false,\r\n    dealStart: false,\r\n  })\r\n  \r\n  const [currentPlayer, setCurrentPlayer] = useState(1);\r\n  const [location, setLocation] = useState(\"\");\r\n  const [spyUsers, setSpyUsers] = useState([]);\r\n\r\n  function getRandomInt(min, max) {\r\n    min = Math.ceil(min);\r\n    max = Math.floor(max);\r\n    let num = Math.floor(Math.random() * (max - min)) + min;\r\n    if (spyUsers.includes(num)) {\r\n        num = getRandomInt(min, max);\r\n    }\r\n    return num;\r\n  }\r\n  const dealStart = () => {\r\n    if (countOfSpyes < 0 || countOfPlayers < 0 || countOfSpyes > 2 || countOfPlayers > 12) {\r\n        return;\r\n    }   \r\n    setGameStatus({\r\n        ...gameStatus,\r\n        dealStart: true,\r\n    })\r\n    const spyIds = [];\r\n    for (let i = 1; i <= countOfSpyes; i += 1) {\r\n        let num = getRandomInt(1, countOfPlayers);\r\n        while (spyUsers.includes(num)) {\r\n            num = getRandomInt(1, countOfPlayers);\r\n        }\r\n        spyIds.push(num);\r\n    }\r\n    setSpyUsers(spyIds);\r\n    setSpyIds(spyIds);\r\n    setLocation(\r\n        LOCATIONS[Object.keys(LOCATIONS)[getRandomInt(1, Object.keys(LOCATIONS).length)]]\r\n    );\r\n  }; \r\n\r\n  const startGame = () => {\r\n    startTimer(countOfPlayers);\r\n    setGameStatus({\r\n        gameStart: true,\r\n        dealStart: false,\r\n    })\r\n  };\r\n  \r\n  const endGame = () => {\r\n    setCurrentPlayer(1);\r\n    setActiveUser(1);\r\n    setSpyUsers([]);\r\n    setLocation('');\r\n    stopTimer();\r\n    setGameStatus({\r\n        gameStart: false,\r\n        dealStart: false\r\n    })\r\n  }\r\n\r\n  const nextPlayer = () => {\r\n    setCurrentPlayer(currentPlayer + 1);\r\n    setActiveUser(currentPlayer + 1);\r\n  };\r\n\r\n  const getSpyesStatus = () => {\r\n    if (countOfPlayers == 12) {\r\n      return countOfSpyes == 2 ? \"valid\" : \"error\";\r\n    } else {\r\n      return countOfSpyes >= 1 && countOfSpyes <= 2 ? \"valid\" : \"error\";\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Panel id={id}>\r\n      <PanelHeader left={<PanelHeaderBack onClick={go} data-to=\"home\" />}>\r\n        Игра\r\n      </PanelHeader>\r\n\r\n      {!gameStatus.dealStart && !gameStatus.gameStart && (\r\n        <Group>\r\n          <Header>Подготовка</Header>\r\n          <FormLayout>\r\n            <FormItem\r\n              top=\"Количество игроков\"\r\n              status={\r\n                countOfPlayers >= 3 && countOfPlayers <= 12 ? \"valid\" : \"error\"\r\n              }\r\n            >\r\n              <Input\r\n                type=\"number\"\r\n                name=\"countOfPlayers\"\r\n                value={countOfPlayers}\r\n                onChange={changeCountOfPlayers}\r\n              />\r\n            </FormItem>\r\n            <FormItem\r\n              top=\"Количество шпионов\"\r\n              status={getSpyesStatus()}\r\n            >\r\n              <Input\r\n                type=\"number\"\r\n                name=\"countOfSpyes\"\r\n                value={countOfSpyes}\r\n                onChange={changeCountOfSpyes}\r\n              />\r\n            </FormItem>\r\n            <FormItem>\r\n              <Button size=\"l\" stretched onClick={dealStart}>\r\n                Начать раздачу\r\n              </Button>\r\n            </FormItem>\r\n          </FormLayout>\r\n        </Group>\r\n      )}\r\n      {gameStatus.dealStart && (\r\n        <Div style={{ textAlign: 'center'}}>\r\n          <Paragraph  style={{display: 'block', marginBottom: 10}}>\r\n            Игрок {currentPlayer}, ознакомтесь с локацией.\r\n          </Paragraph>\r\n          <ButtonGroup stretched mode=\"vertical\">\r\n            <Button\r\n              stretched\r\n              mode=\"secondary\"\r\n              size=\"m\"\r\n              onClick={() => openLocationModal(spyUsers.includes(currentPlayer)\r\n                ? \"Вы шпион\"\r\n                : location)\r\n              }\r\n            >\r\n              Показать локацию\r\n            </Button>\r\n            {currentPlayer < countOfPlayers && (\r\n              <Button\r\n                stretched\r\n                mode=\"secondary\"\r\n                size=\"m\"\r\n                onClick={nextPlayer}\r\n              >\r\n                Следующий игрок\r\n              </Button>\r\n            )}\r\n            {currentPlayer == countOfPlayers && (\r\n              <Button stretched mode=\"secondary\" size=\"m\" onClick={startGame}>\r\n                Начать игру\r\n              </Button>\r\n            )}  \r\n          </ButtonGroup>\r\n        </Div>\r\n      )}\r\n      {gameStatus.gameStart && (\r\n        <Div style={{ display: 'flex', alignItems: 'center', flexDirection: 'column', }}>\r\n          <Paragraph>Игра началась!</Paragraph>\r\n          <Paragraph style={{fontSize: '20px', margin: '10px'}}>{timer}</Paragraph>\r\n          <Button stretched mode=\"secondary\" size=\"m\" onClick={endGame}>\r\n                Закончить игру\r\n          </Button>\r\n        </Div>\r\n      )}\r\n    </Panel>\r\n  );\r\n};\r\n\r\nGame.propTypes = {\r\n  id: PropTypes.string.isRequired,\r\n  go: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default Game;","import { createSlice } from \"@reduxjs/toolkit\";\r\n\r\nexport const locationsSlice = createSlice({\r\n    name: \"locations\",\r\n    initialState: {},\r\n    reducers: {\r\n        addLocation(state, action) {\r\n            state[state.nextLocationId] = action.payload;\r\n        },\r\n        removeLocation(state, action) {\r\n            if (state.hasOwnProperty(action.payload)) {\r\n                delete state.locations[payload.payload];\r\n            }\r\n        },\r\n    },\r\n});\r\n\r\n// Extract the action creators object and the reducer\r\nconst { actions, reducer } = locationsSlice;\r\n// Extract and export each action creator by name\r\nexport const { addLocation, removeLocation } = actions;\r\n// Export the reducer, either as a default or named export\r\nexport default reducer;","import React, { createRef } from \"react\";\r\n\r\nimport {\r\n  Panel,\r\n  PanelHeader,\r\n  PanelHeaderBack,\r\n  Group,\r\n  FormItem,\r\n  Input,\r\n  Button,\r\n  Div,\r\n  ButtonGroup,\r\n  SimpleCell,\r\n  IconButton,\r\n} from \"@vkontakte/vkui\";\r\n\r\nimport {\r\n    Icon28RemoveCircleOutline,\r\n  } from \"@vkontakte/icons\";\r\n\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { addLocation, removeLocation } from \"../store/reducers/locationsReducer\";\r\n\r\nconst CreateLocations = ({ id, go }) => {\r\n  const newLocation = createRef();\r\n  const dispatch = useDispatch();\r\n  const locationsList = useSelector((state) => state.locations);\r\n\r\n  const createLocation = () => {\r\n    dispatch(addLocation(newLocation.current.value));\r\n    newLocation.current.value = \"\";\r\n  };\r\n\r\n  return (\r\n    <Panel id={id}>\r\n      <PanelHeader left={<PanelHeaderBack onClick={go} data-to=\"home\" />}>\r\n        Добавить локацию\r\n      </PanelHeader>\r\n      <Group>\r\n        <Div>\r\n          <FormItem top=\"Введите название локации\">\r\n            <Input type=\"text\" getRef={newLocation} />\r\n          </FormItem>\r\n          <ButtonGroup style={{ display: 'flex', justifyContent: 'center'}}>\r\n            <Button style={{width:'300px'}} mode=\"outline\" onClick={createLocation}>\r\n              Добавить\r\n            </Button>\r\n          </ButtonGroup>\r\n        </Div>\r\n        <Div>\r\n          {Object.keys(locationsList)?.map((locationId) => (\r\n            <SimpleCell\r\n            key={locationId}\r\n              after={\r\n                <IconButton\r\n                  onClick={() => dispatch(removeLocation(locationId))}\r\n                >\r\n                  <Icon28RemoveCircleOutline />\r\n                </IconButton>\r\n              }\r\n            >\r\n              {locationsList[locationId]}\r\n            </SimpleCell>\r\n          ))}\r\n        </Div>\r\n      </Group>\r\n    </Panel>\r\n  );\r\n};\r\n\r\nexport default CreateLocations;","import { configureStore } from \"@reduxjs/toolkit\";\r\nimport locationsReducer from \"./reducers/locationsReducer\";\r\n\r\nexport default configureStore({\r\n  reducer: {\r\n    locations: locationsReducer,\r\n  },\r\n});","import React, { useState, useEffect } from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport { View, ScreenSpinner, AdaptivityProvider, AppRoot, ConfigProvider, SplitLayout, SplitCol, ModalRoot, ModalCard, FormItem, Input, Button } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport './static/global.css'\n\nimport Home from './panels/Home';\nimport Locations from './panels/Locations';\nimport Game from './panels/Game';\nimport CreateLocations from './panels/createLocations';\nimport { Provider } from 'react-redux';\nimport store from './store';\n\nconst App = () => {\n\tconst [scheme, setScheme] = useState('bright_light')\n\tconst [activePanel, setActivePanel] = useState('home');\n\tconst [activeModal, setActiveModal] = useState('');\n\tconst [location, setLocation] = useState('');\n\tconst [timer, setTimer] = useState('');\n\tconst [timerId, setTimerId] = useState('');\n\tconst [flashLightIsAvailable, setFlasLightIsAvailable] = useState(false);\n\tconst [name, setName] = useState('');\n\tconst [activeUser, setActiveUser] = useState(1);\n\tconst [spyIds, setSpyIds] = useState([]);\n\tconst [spyNames, setSpyNames] = useState([]);\n\tfunction addMinutes(date, minutes) {\n\t\treturn new Date(date.getTime() + minutes * 60000);\n\t}\n\n\tfunction countdownTimer(deadline) {\n\t\tconst diff = deadline - new Date();\n\t\tif (diff <= 0) {\n\t\t\tstopTimer();\n\t\t\tif (flashLightIsAvailable) {\n\t\t\t\tbridge.send(\"VKWebAppFlashSetLevel\", { level: 1 });\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tbridge.send(\"VKWebAppFlashSetLevel\", { level: 0 });\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t}\n\t\tconst minutes = diff > 0 ? Math.floor(diff / 1000 / 60) % 60 : 0;\n\t\tconst seconds = diff > 0 ? Math.floor(diff / 1000) % 60 : 0;\n\t\tsetTimer(`${minutes}:${seconds < 10 ? `0${seconds}` : seconds}`);\n\t}\n\n\tconst startTimer = (count) => {\n\t\tconst deadline = addMinutes(new Date(), 1);\n\n\t\tcountdownTimer(deadline);\n\n\t\tsetTimerId(setInterval(() => countdownTimer(deadline), 1000));\n\t}\n\n\tconst stopTimer = () => {\n\t\tsetTimer('');\n\t\tsetName('');\n\t\tclearInterval(timerId);\n\t\tsetActiveModal('spy');\n\t}\n\n\tconst closeSpyModal = () => {\n\t\tsetSpyNames([]);\n\t\tsetSpyIds([]);\n\t\tsetActiveModal('');\n\t}\n\n\n\tuseEffect(() => {\n\t\tbridge.subscribe(({ detail: { type, data } }) => {\n\t\t\tif (type === 'VKWebAppUpdateConfig') {\n\t\t\t\tsetScheme(data.scheme)\n\t\t\t}\n\t\t\tif (type === \"VKWebAppFlashGetInfoResult\") {\n\t\t\t\tsetFlasLightIsAvailable(data.is_available);\n\t\t\t\tif (data.is_available) {\n\t\t\t\t\tbridge.send(\"VKWebAppFlashSetLevel\", { level: 0 });\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t}, []);\n\n\tconst go = e => {\n\t\tsetActivePanel(e.currentTarget.dataset.to);\n\t};\n\n\tconst openLocationModal = (location, user) => {\n\t\tsetActiveModal('location');\n\t\tsetLocation(location);\n\t}\n\n\tconst saveNameAndClose = (name) => {\n\t\tif (name === '') {\n\t\t\treturn;\n\t\t}\n\n\t\tif (spyIds.includes(activeUser)) {\n\t\t\tspyNames.push(name);\n\t\t}\n\n\t\tsetActiveModal('');\n\t\tsetName('');\n\t}\n\n\tconst modal = (\n\t\t<ModalRoot activeModal={activeModal}>\n\t\t\t<ModalCard\n\t\t\t\tstyle={{\n\t\t\t\t\theight: '200px',\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\tjustifyContent: 'center',\n\t\t\t\t\talignItems: 'center',\n\t\t\t\t\tfontSize: '18px'\n\t\t\t\t}}\n\t\t\t\tonClose={() => saveNameAndClose(name)}\n\t\t\t\tid=\"location\">\n\t\t\t\t{location}\n\n\t\t\t\t<FormItem top=\"Имя\" status={name && name.length > 0 ? \"valid\" : \"error\"}>\n\t\t\t\t\t<Input type=\"text\" onChange={(e) => setName(e.target.value)} />\n\t\t\t\t</FormItem>\n\n\t\t\t\t<Button stretched mode=\"secondary\" size=\"m\" onClick={() => saveNameAndClose(name)}>\n\t\t\t\t\tСохранить\n\t\t\t\t</Button>\n\t\t\t</ModalCard>\n\t\t\t<ModalCard\n\t\t\t\tstyle={{\n\t\t\t\t\theight: '200px',\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\tjustifyContent: 'center',\n\t\t\t\t\talignItems: 'center',\n\t\t\t\t\tfontSize: '18px'\n\t\t\t\t}}\n\t\t\t\tonClose={() => closeSpyModal()}\n\t\t\t\tid=\"spy\">\n\t\t\t\tШпион - {spyNames.join(',')}\n\t\t\t</ModalCard>\n\t\t</ModalRoot>)\n\n\treturn (\n\t\t<Provider store={store}>\n\t\t\t<ConfigProvider scheme={scheme}>\n\t\t\t\t<AdaptivityProvider>\n\t\t\t\t\t<AppRoot>\n\t\t\t\t\t\t<SplitLayout modal={modal}>\n\t\t\t\t\t\t\t<SplitCol>\n\t\t\t\t\t\t\t\t<View activePanel={activePanel}>\n\t\t\t\t\t\t\t\t\t<Locations id='locations' go={go} />\n\t\t\t\t\t\t\t\t\t<Home id='home' go={go} />\n\t\t\t\t\t\t\t\t\t<Game\n\t\t\t\t\t\t\t\t\t\tid='game'\n\t\t\t\t\t\t\t\t\t\tgo={go}\n\t\t\t\t\t\t\t\t\t\topenLocationModal={openLocationModal}\n\t\t\t\t\t\t\t\t\t\ttimer={timer}\n\t\t\t\t\t\t\t\t\t\tstartTimer={startTimer}\n\t\t\t\t\t\t\t\t\t\tstopTimer={stopTimer}\n\t\t\t\t\t\t\t\t\t\tsetActiveUser={setActiveUser}\n\t\t\t\t\t\t\t\t\t\tsetSpyIds={setSpyIds} />\n\t\t\t\t\t\t\t\t\t<CreateLocations id=\"createLocations\" go={go} />\n\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t</SplitCol>\n\t\t\t\t\t\t</SplitLayout>\n\t\t\t\t\t</AppRoot>\n\t\t\t\t</AdaptivityProvider>\n\t\t\t</ConfigProvider>\n\t\t</Provider>\n\t);\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}